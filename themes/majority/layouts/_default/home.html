{{ define "main" }}
{{ if .Content }}
<div class="home-content">
    <div class="container">
        {{ .Content }}
    </div>
</div>
{{ end }}

{{ if .Site.Params.showRecentPosts }}
{{ $allPosts := where (where .Site.RegularPages "Type" "posts") "Draft" false }}
{{ $posts := sort $allPosts "Date" "desc" }}
<div class="recent-posts">
    <div class="container">
        <div class="posts-grid">
            {{ range first 4 $posts }}
            <article class="post-card">
                <a href="{{ .Permalink }}">
                    {{ if .Params.featuredImage }}
                    <div class="post-image">
                        <img src="{{ .Params.featuredImage | relURL }}" alt="{{ .Title }}">
                    </div>
                    {{ end }}
                    <div class="post-content">
                        <h3>{{ .Title }}</h3>
                        {{ if .Summary }}
                        <div class="post-excerpt">{{ .Summary }}</div>
                        {{ else if .Description }}
                        <p class="post-excerpt">{{ .Description }}</p>
                        {{ end }}
                        <time datetime="{{ .Date.Format " 2006-01-02" }}">{{ .Date.Format "January 2, 2006" }}</time>
                    </div>
                </a>
            </article>
            {{ end }}
        </div>

        {{ $remainingPosts := after 4 $posts }}
        {{ if $remainingPosts }}
        {{ $totalArticles := len $remainingPosts }}
        {{ $articlesPerPage := 9 }}
        {{ $totalPages := div (add $totalArticles (sub $articlesPerPage 1)) $articlesPerPage }}
        <div class="recent-articles-box">
            <div class="recent-articles-grid" id="articles-grid">
                {{ range $remainingPosts }}
                <article class="recent-article-card">
                    <a href="{{ .Permalink }}">
                        {{ if .Params.featuredImage }}
                        <div class="recent-article-image">
                            <img src="{{ .Params.featuredImage | relURL }}" alt="{{ .Title }}">
                        </div>
                        {{ end }}
                        <div class="recent-article-title">{{ .Title }}</div>
                    </a>
                </article>
                {{ end }}
            </div>
            
            {{ if gt $totalPages 1 }}
            <div class="pagination" id="articles-pagination" data-total-pages="{{ $totalPages }}" data-per-page="{{ $articlesPerPage }}">
                <a href="#" class="pagination-link pagination-prev" id="pagination-prev">← Previous</a>
                
                <div class="pagination-numbers" id="pagination-numbers">
                    <!-- Page numbers will be generated by JavaScript -->
                </div>
                
                <a href="#" class="pagination-link pagination-next" id="pagination-next">Next →</a>
            </div>
            {{ end }}
        </div>
        {{ end }}
    </div>
</div>
{{ end }}
{{ end }}